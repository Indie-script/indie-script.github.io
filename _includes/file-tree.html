<!--
Improved _includes/file-tree.html
Compatible with GitHub Pages safe Liquid syntax
-->

<div class="file-tree">
    <ul>
      <li>
        <a href="{{ site.baseurl }}/" class="{% if page.url == '/' %}active{% endif %}">Home</a>
      </li>
  
      {% assign all_pages = site.pages | sort: 'path' %}
  
      {%- assign indicators = '' | split: '' -%}
      {%- assign docs = '' | split: '' -%}
      {%- assign root_pages = '' | split: '' -%}
      {%- assign doc_readme = '' -%}
  
      {% for item in all_pages %}
        {% assign p = item.path %}
        {% unless p contains '_' or p == '404.html' or p == 'feed.xml' %}
          {% if p contains 'indicators/' and p contains 'README' %}
            {% assign indicators = indicators | push: item %}
          {% elsif p contains 'docs/' %}
            {% if p == 'docs/README.md' %}
              {% assign doc_readme = item %}
            {% else %}
              {% assign docs = docs | push: item %}
            {% endif %}
          {% elsif p contains '/' == false %}
            {% assign root_pages = root_pages | push: item %}
          {% endif %}
        {% endunless %}
      {% endfor %}
  
      {% if root_pages.size > 0 %}
      <li class="section-header">Pages</li>
      {% for page_item in root_pages %}
        <li class="file-item">
          <a href="{{ site.baseurl }}{{ page_item.url }}" class="{% if page.url == page_item.url %}active{% endif %}">
            {{ page_item.path | replace: '.md', '' | replace: '.html', '' }}
          </a>
        </li>
      {% endfor %}
      {% endif %}
  
      {% if indicators.size > 0 %}
      <li class="section-header">Indicators</li>
      {% for item in indicators %}
        {% assign parts = item.path | split: '/' %}
        {% assign folder_name = parts[1] %}
        <li class="file-item">
          <a href="{{ site.baseurl }}{{ item.url }}" class="{% if page.url == item.url %}active{% endif %}">
            {{ folder_name | replace: '-', ' ' }}
          </a>
        </li>
      {% endfor %}
      {% endif %}
  
      {% if doc_readme or docs.size > 0 %}
      <li class="section-header">Docs</li>
      <li class="directory">
        <details {% if page.path contains 'docs/' %}open{% endif %}>
          <summary>
            <div class="directory-container">
              <span class="directory-item">docs</span>
              <span class="toggle-btn" onclick="event.preventDefault(); toggleDetailsClick(this)">â–¼</span>
            </div>
          </summary>
          <ul>
            {% if doc_readme %}
            <li class="file-item">
              <a href="{{ site.baseurl }}{{ doc_readme.url }}" class="{% if page.url == doc_readme.url %}active{% endif %}">README</a>
            </li>
            {% endif %}
            {% for page_item in docs %}
            <li class="file-item">
              <a href="{{ site.baseurl }}{{ page_item.url }}" class="{% if page.url == page_item.url %}active{% endif %}">
                {{ page_item.path | split: '/' | last | replace: '.md', '' | replace: '.html', '' }}
              </a>
            </li>
            {% endfor %}
          </ul>
        </details>
      </li>
      {% endif %}
  
    </ul>
  </div>
  